<?php
namespace ApplicationTest\Controller;

use \Application\Controller\SystemController,
    Zend\Http\Request,
    Zend\Http\Response,
    Zend\Mvc\MvcEvent,
    Zend\Mvc\Router\RouteMatch
;

/**
 * Generated by PHPUnit_SkeletonGenerator on 2016-02-10 at 23:14:54.
 */
class SystemControllerTest extends BaseActionControllerTest
{
	
	/**
	 * Sets up the fixture, for example, opens a network connection.
	 * This method is called before a test is executed.
	 */
	public function setupController()
	{
		$this->setController(new SystemController());
		$this->controller->setServiceLocator($this->getApplicationServiceLocator());
		$this->controller->setEvent($this->event);
		$this->routeMatch	= new RouteMatch(array('controller' => 'system'));
	}

	/**
	 * Tears down the fixture, for example, closes a network connection.
	 * This method is called after a test is executed.
	 */
	protected function tearDown()
	{
		parent::tearDown();
	}
	
	/**
	 * is the action dispatchable per route setting ?
	 */
	public function testIndexActionCanBeDispatchedByRoute()
	{
		$this->dispatch('/system/');
		$this->assertResponseStatusCode(200);
	
		$this->assertModuleName('Application');
		$this->assertControllerName('Application\Controller\System');
		$this->assertControllerClass('SystemController');
		$this->assertMatchedRouteName('system');
	}

	/**
	 * is the action accessable per request/response action name ?
	 */
	public function testIndexActionCanBeDispatchedByAction()
	{
		// Specify which action to run
		$this->routeMatch->setParam('action', 'index');
	
		// Kick the controller into action
		$result = $this->controller->dispatch($this->request);
	
		// Check the HTTP response code
		$response = $this->controller->getResponse();
		$this->assertEquals(200, $response->getStatusCode());
	
		// Check for a ViewModel to be returned
		$this->assertInstanceOf('Zend\View\Model\ViewModel', $result);
	
		// Test the parameters contained in the View model
		//$vars = $result->getVariables();
		//$this->assertTrue(isset($vars['var']));
	}
	
	public function test404()
	{
		$this->routeMatch->setParam('action', 'not-implemented-yet');
		$result = $this->controller->dispatch($this->request);
		$response = $this->controller->getResponse();
		$this->assertEquals(404, $response->getStatusCode());
	}
	
}